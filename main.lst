C51 COMPILER V9.01   MAIN                                                                  03/04/2017 09:16:44 PAGE 1   


C51 COMPILER V9.01, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN .\hex\main.obj
COMPILER INVOKED BY: D:\Keil_C51\C51\BIN\C51.EXE main\main.c INCDIR(.\fireSensor;.\main;.\motor;.\trace) PRINT(.\main.ls
                    -t) OBJECT(.\hex\main.obj)

line level    source

   1          #include <reg52.h>
   2          #include "motor.h"
   3          #include "trace.h"
   4          #include "firesensor.h"
   5          int  angle=0;
   6          bit  pwmFlag=0;
   7          sbit beep=P2^3;
   8          sbit angleMotor=P1^2;
   9          sbit fan=P2^5;                          //连接继电器的引脚，控制风扇
  10          uchar angleMotorCount=0;
  11          extern uint fireSensorAngle[5];
  12          extern char fireFlag;
  13          void delayms(uint xms)
  14          {
  15   1       uint i,j;
  16   1       for(i=xms;i>0;i--)
  17   1              for(j=110;j>0;j--);
  18   1      }
  19          void main(void)         
  20          {
  21   1              initWheelMotor();                               //初始化轮子舵机
  22   1              delayms(2);
  23   1              initAngleMotor();                               //初始化角度舵机，控制风扇
  24   1              delayms(2);
  25   1              while(1)
  26   1              {
  27   2                      angle=checkFire();                      //传回度数
  28   2                      if(fireFlag<0)
  29   2                      {
  30   3                              fan=0;                                  //关闭继电器
  31   3                              trace();                                //如果没有火焰就循迹
  32   3                      }
  33   2                      else                                            //有火焰就灭火
  34   2                      {
  35   3                              delayms(10);                    //防止误测
  36   3                              if(fireFlag)
  37   3                                      fan=1;                          //打开继电器    
  38   3                      }
  39   2              }
  40   1      }
  41          
  42          void Tim1forWheel(void) interrupt 3                             //两个轮子
  43          {
  44   1              EA=0;
  45   1              wheelMotorInterrupt();
  46   1              EA=1;
  47   1      }
  48          void Tim0forAngleMotor(void) interrupt 1
  49          {
  50   1              TR0=0;
  51   1              TH0=(65536-100)/256;
  52   1              TL0=(65536-100)%256;
  53   1              if(angle>angleMotorCount)                                 //18,最左，3最右
  54   1                       angleMotor=1;  
C51 COMPILER V9.01   MAIN                                                                  03/04/2017 09:16:44 PAGE 2   

  55   1              else
  56   1                      angleMotor=0;
  57   1              angleMotorCount++;
  58   1              if(angleMotorCount>=200)
  59   1                      angleMotorCount=0;
  60   1              TR0=1;
  61   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    208    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =      3    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =      1    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
